<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <h1>Single Player</h1>
    <h2>Add the maze</h2>
    <h3>is there a change?</h3>
    <h4 id="h4"></h4>
    Name: <input type="text" id="mazeName"/><br/>
    Rows: <input type="number" id="mazeRow"/><br/>
    Cols: <input type="number" id="mazeCol"/><br/>
    <button id="btnAddMaze">Submit Maze</button>

    <canvas id="mazeCanvas" width="500" height="480" style="border:2px black
    solid; margin-left: 40%; margin-top: -10%"></canvas>

    <p1 id="showInput1"></p1>
    <p2 id="showInput2"></p2>
    <p3 id="showInput3"></p3>
    <p4 id="showInput4"></p4>

    <script src="Scripts/jquery-3.1.1.js"></script>
    <script src="DrawMazePlugin.js"></script>
    <script>

        
        var startRow;
        var startCol;
        var endRow;
        var endCol;
        var myMazeBoard;
        var flag = false;

        document.getElementById("btnAddMaze").onclick = sendToServer;

        //document.onkeydown = findKey;
        //document.addEventListener('keydown', findKey, true);

        function sendToServer() {
            
            var mName = document.getElementById("mazeName").value;
            var mRow = document.getElementById("mazeRow").value;
            var mCol = document.getElementById("mazeCol").value;
            
            var apiUrl = "api/Maze/5?" + "name=" + mName + "&rows=" + mRow +
                "&cols=" + mCol;

            $.getJSON(apiUrl).done(function (data) {
                var mazeRep = data.Maze;
                document.getElementById("showInput1").innerHTML = mazeRep;
                var startRow = data.Start.Row;
                var startCol = data.Start.Col;
                var endRow = data.End.Row;
                var endCol = data.End.Col;

                //document.getElementById("showInput2").innerHTML = startRow + "," + startCol;

                //document.getElementById("showInput3").innerHTML = endRow + "," + endCol;

                //get the maze representation, and put it in a 2D matrix
                var splitMazeRep = mazeRep.split('');

                var arrRow = [];

                for (var i = 0; i < mRow; i++) {
                    arrRow[i] = [];
                    var imCol = i * mCol;
                    for (var j = 0; j < mCol; j++) {
                        arrRow[i][j] = splitMazeRep[imCol + j];
                    };
                };

                var mazeData = arrRow;
                myMazeBoard = $.fn.mazeBoard(
                    mazeData, // the matrix containing the maze cells
                    startRow, startCol, // initial position of the player
                    endRow, endCol, // the exit position
                    "pooh.gif", // player's icon (of type Image)
                    "hJar.jpg", // exit's icon (of type Image)
                );
                //myMazeBoard.drawMaze();
            });
            flag = true;
        }


        // add restart game option!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
        /*
        function findKey(event) {
            event = event || window.event;
            var e = event.keyCode;
            if (flag == true) {
                //document.getElementById("showInput1").innerHTML = "blaahhhhhh!";
                myMazeBoard.movePlayer(e);
            }
        }
        */



    </script>

</body>
</html>